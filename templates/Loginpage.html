{% extends "Layout.html" %}
{% block content %}

<style>
#first-panel {
   height: 100%;
   background-color: white;
}
#second-panel {
   display: none;
   height: 100%;
   background-color: white;
}
</style>

<div class="pure-g" style="height: 100%; display: table-cell;">
  <div class="pure-u-1-2" style="height: 100%;">

    <div id="first-panel">
      <div class="content">
        <h2 class="content-head is-center">Login to make orders and more!</h2>
        <hr>

        <form class="pure-form pure-form-stacked">
          <fieldset>
        
            <div class="pure-g">
              
              <div class="pure-u-1 pure-u-md-6-24">
              </div>
          
              <div class="pure-u-1 pure-u-md-1-3">
                <label for="login-username">Username <b style="color: red;">*</b></label>
                <input id="login-username" class="pure-u-20-24" name="login-username" type="text" placeholder="Username">
              </div>
          
              <div class="pure-u-1 pure-u-md-1-3">
                <label for="login-acc-type">Account Type</label>
                <select id="login-acc-type" name="login-acc-type" class="pure-u-1-2">
                  <option>Customer</option>
                  <option>Chef</option>
                  <option>Admin</option>
                </select>
              </div>

              <div class="pure-u-1 pure-u-md-2-24">
              </div>

              <!-- one row -->
              
              <div class="pure-u-1 pure-u-md-6-24">
              </div>

              <div class="pure-u-1 pure-u-md-1-3">
                <label for="login-password">Password <b style="color: red;">*</b></label>
                <input id="login-password" class="pure-u-20-24" name="login-password" type="password" placeholder="Password">
              </div>

              <!-- other row -->
          
            </div>

            <!-- button row -->
            <div class="pure-g">
              <div class="pure-u-1 pure-u-md-6-24">
              </div>          

              <div class="pure-u-1 pure-u-md-1-3">
                <div style="display: block; margin-bottom: 10px;">
                  <a id="register-link" href="#" style="font-size: 0.9em;">Don't have an account? Register here.</a>
                </div>
                <button id="login-btn" class="pure-button pure-button-primary" type="button">Login</button>
              </div>
            </div>

          </fieldset>
        </form>

      </div>
    </div>
  </div>

  <div class="pure-u-1-2" style="height: 100%;">

    <div id="second-panel">
      <div class="content">
        <h2 class="content-head is-center">Registration</h2>
        <hr>

        <form class="pure-form pure-form-stacked">
          <fieldset>
        
            <div class="pure-g">

              <div class="pure-u-1 pure-u-md-6-24">
              </div>

              <div class="pure-u-1 pure-u-md-1-3">
                <label for="reg-name">Name <b style="color: red;">*</b></label>
                <input id="reg-name" class="pure-u-20-24" name="reg-name" type="text" placeholder="Name">
              </div>

              <div class="pure-u-1 pure-u-md-10-24">
              </div>

              <!-- row -->
              
              <div class="pure-u-1 pure-u-md-6-24">
              </div>
          
              <div class="pure-u-1 pure-u-md-1-3">
                <label for="reg-username">Username <b style="color: red;">*</b></label>
                <input id="reg-username" class="pure-u-20-24" name="reg-username" type="text" placeholder="Username">
              </div>
          
              <div class="pure-u-1 pure-u-md-1-3">
                <label for="reg-acc-type">Account Type</label>
                <select id="reg-acc-type" class="pure-u-1-2" disabled>
                  <option>Customer</option>
                  <option>Chef</option>
                  <option>Admin</option>
                </select>
              </div>

              <div class="pure-u-1 pure-u-md-2-24">
              </div>

              <!-- one row -->
              
              <div class="pure-u-1 pure-u-md-6-24">
              </div>

              <div class="pure-u-1 pure-u-md-1-3">
                <label for="reg-password">Password <b style="color: red;">*</b></label>
                <input id="reg-password" class="pure-u-20-24" name="reg-password" type="password" placeholder="Password">
              </div>

              <div class="pure-u-1 pure-u-md-1-3">
                <label for="reg-phone">Phone</label>
                <input id="reg-phone" class="pure-u-20-24" name="reg-phone" type="text" placeholder="Phone">
              </div>


              <!-- other row -->

              <div class="pure-u-1 pure-u-md-6-24">
              </div>

              <div class="pure-u-1 pure-u-md-1-3">
                <label for="reg-confirm-password">Confirm Password <b style="color: red;">*</b></label>
                <input id="reg-confirm-password" class="pure-u-20-24" type="password" placeholder="Confirm Password">
              </div>

              <div class="pure-u-1 pure-u-md-1-3">
                <label for="reg-address">Address</label>
                <input id="reg-address" class="pure-u-20-24" name="reg-address" type="text" placeholder="Address">
              </div>

            </div>

            <!-- button row -->
            <div class="pure-g">
              <div class="pure-u-1 pure-u-md-6-24">
              </div>          

              <div class="pure-u-1 pure-u-md-1-3">
                <div style="display: block; margin-bottom: 10px;">
                  <a id="login-link" href="#" style="font-size: 0.9em;">Already have an account? Login here.</a>
                </div>
                <button id="create-btn" class="pure-button pure-button-primary" type="button">Create</button>
              </div>
            </div>

          </fieldset>
        </form>

      </div>
    </div>


  </div>

</div>

<script>

$("#register-link").click(function () {
   $("#second-panel").fadeIn(600);
   $("#first-panel").fadeOut(800);
});

$("#login-link").click(function () {
   $("#first-panel").fadeIn(600);
   $("#second-panel").fadeOut(800);
});

$("#login-btn").click(function () {
   if ($("#login-username").val().trim() === '' ||
       $("#login-password").val().trim() === '') {
      alert("A required field is missing. Try again.");
      return;
   }

   $.ajax({
      url: "/login",
      type: "POST",
      data: {
         "login-username": $("#login-username").val(),
         "login-password": $("#login-password").val(),
         "login-acc-type": $("#login-acc-type").val()
      },
      success: function () {
         window.location.replace("/");
      },
      error: function () {
         alert('Login failed. Try again.');
      }
   });
});

$("#create-btn").click(function () {
   if ($("#reg-name").val().trim() === '' ||
       $("#reg-username").val().trim() === '' ||
       $("#reg-password").val().trim() === '' ||
       $("#reg-confirm-password").val().trim() === '') {
      alert("A required field is missing. Try again.");
      return;
   }

   if ($("#reg-password").val() !== $("#reg-confirm-password").val()) {
      alert("Passwords differ. Try again.");
      return;
   }

   $.ajax({
      url: "/account/customer/create",
      type: "POST",
      data: {
         "reg-name": $("#reg-name").val(),
         "reg-username": $("#reg-username").val(),
         "reg-password": $("#reg-password").val(),
         "reg-phone": $("#reg-phone").val(),
         "reg-address": $("#reg-address").val()
      },
      success: function (data) {
         console.log(data);
         window.location.replace("/login");
         alert("Account creation succeeded. You may now log in.");
      },
      error: function (data) {
         console.log(data);
         alert("Account creation failed. Try again.");
      }
   });

});


</script>

{% endblock %}
